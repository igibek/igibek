<!DOCTYPE html>
<html lang="en">

  
  <head>    
    

    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Igibek  Koishybayev | HackPack CTF: GitHub Actions Challenges</title>
    <meta name="author" content="Igibek  Koishybayev" />
    <meta name="description" content="HackPack CTF'22 challenge development process" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://igibek.com/blog/2022/hackpack-ctf-github-actions/">
    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  
  <body class="fixed-top-nav ">

    
    <header>

      
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://igibek.com/"><span class="font-weight-bold">Igibek</span>   Koishybayev</a>
          
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/">teaching</a>
              </li>

              
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    
    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">HackPack CTF: GitHub Actions Challenges</h1>
    <p class="post-meta">April 24, 2022</p>
    <p class="post-tags">
      <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>
        ·  
        <a href="/blog/tag/security">
          <i class="fas fa-hashtag fa-sm"></i> security</a>  
          <a href="/blog/tag/ci/cd">
          <i class="fas fa-hashtag fa-sm"></i> ci/cd</a>  
          <a href="/blog/tag/ctf">
          <i class="fas fa-hashtag fa-sm"></i> ctf</a>  
          

    </p>
  </header>

  <article class="post-content">
    <p>Since 2018, as a hackpack team, we host HackPack CTF annually. Following the tradition, this year we hosted the catch the flag challenge in April. If you have experience in hosting CTF competitions, you know that one of the hardest parts of organizing such kinds of events is to develop challenges that will be interesting for everyone. Every year, we sit down together and start brainstorming about challenges 2 to 3 months in advance before the date of the competition. This year, I developed two challenges (1) <a href="https://github.com/hackpack-ncsu/geet-into-action" target="_blank" rel="noopener noreferrer">Geet-into-actions</a> and (2) <a href="https://github.com/hackpack-ncsu/geet-into-action" target="_blank" rel="noopener noreferrer">Geet-into-reactions</a>. As you can guess from the name the challenges are related to GitHub Actions. GitHub Actions is a CI/CD platform introduced by GitHub that gained tremendous popularity among open-source communities and developers in recent years. 
Since this was the first time when I am developing challenges related to CI/CD pipeline, the development process was quite challenging for me. In the past, I usually created web challenges with injection vulnerabilities (SQL, command), XXE, path traversal and etc.</p>

<p>In this post, I want to write about the difficulties that I faced during the development process and the shortcuts I made. If you have good experience in developing CI/CD-related CTF challenges, please let me know in the comments so that I will use your approach.</p>

<p>In short, GitHub Actions is one of the public CI/CD platforms such as Travis-CI, Circle-CI, and others that is maintained by GitHub itself, which makes it a popular choice for projects hosted on GitHub.</p>

<p>To use the GitHub Actions developers need to write a workflow configuration file under the .github/workflows folder inside the repository. The workflow configuration file is a YAML file that defines events that trigger the workflow, and jobs that are executed if certain events are fired. The jobs consist of N number of steps (aka commands) executed in order. Inside the commands, developers can use events data to perform tasks. For example, one can write a build command to be executed if the issue with the title “[build]” is created.</p>

<p>The basic idea of the challenge was to subvert the execution flow of the CI/CD pipeline by injecting code into the job through the creation of the issue. While the first challenge’s attack is straightforward, for the second challenge you need to have to create an issue that follows a certain format. You can access both challenges by following links: geet-into-action and geet-into-reaction.</p>

<p>In addition to injecting the code, attackers need to figure out how to extract secrets from the CI/CD pipeline. GitHub Actions by default masks all the secrets. Therefore you can not just print out the secrets into the console. You have to manipulate it a little bit to be able to print it out. 
During the development of the challenges, I faced mainly two problems:</p>
<ol>
  <li>Where I can host the CI/CD pipeline runner?</li>
  <li>How I can hide the traces of the exploit from other competitors?</li>
</ol>

<p>For the first problem, I ended up using default hosting by GitHub instead of hosting the pipeline runner in a VM. GitHub itself does not suggest using the self-hosted environment due to security risks. Since I know that both of the challenges’ workflows contain code injection vulnerability, I do not want to run arbitrary code inside the VM, even if it is isolated from the host machine. I wanted to avoid the situations when participants destroy (un)intentionally the VM so that others will not be able to solve the challenges. To our surprise, GitHub provides unlimited runtime minutes for public repositories. Even though, we were worried that GitHub will block our repository that hosts challenges due to suspicious activities. I think, at the highest workload participants were creating 20-30 issues per minute inside the repositories that were starting the execution of the workflow. To avoid stressing the GitHub infrastructure, we on purpose set the timeout minute for the challenges to 1 and 2 minutes respectively.</p>

<p>For the second problem, I ended up creating another job and workflow which will be executed immediately after the initial job and workflow finish execution. The goal of this job and workflow was to clean all the traces of other participants’ exploits. Since participants are using the issue to inject, others can copy the solution by just looking at others’ issues. Unfortunately, GitHub does not allow the deletion of the issue, but it allows us to edit the issue. That is what the job does. It edits the body and the title of the issue as soon as the vulnerable workflow starts running. Another thing to hide is the solution itself. Developers can access the execution traces of all workflows by navigating to the Actions tab in the repository. We don’t want the situation when other participants can just read the flag (solution) by reading the execution traces of previous workflow runs. Therefore, I created a cleaner workflow that is fired after the vulnerable workflow finishes execution, which removes the workflow’s traces that triggered the cleaner workflow.</p>

<p>I think that is it. In general, it was quite an interesting experience to develop CTF challenges related to CI/CD pipeline. If I will have a chance next year, I would like to work on a more complicated CI/CD pipeline challenge that needs the chaining of several vulnerabilities to find the flag.</p>

<p><em>PS: You can access the challenges by following these links: <a href="https://github.com/hackpack-ncsu/geet-into-action" target="_blank" rel="noopener noreferrer">geet-into-action</a> and <a href="https://github.com/hackpack-ncsu/geet-into-reaction" target="_blank" rel="noopener noreferrer">geet-into-reaction</a>, and try to solve them yourself. If you think I should have taken a different approach to creating these challenges, please let me know in the comments.</em></p>

  </article>

</div>

    </div>

        
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2022 Igibek  Koishybayev. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.
Last updated: November 30, 2022.
      </div>
    </footer>

    
    
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script>
  <script src="/assets/js/common.js"></script>

    
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

